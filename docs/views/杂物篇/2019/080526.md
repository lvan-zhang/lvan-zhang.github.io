---
title: 疑难杂症：百度地图不允许定位后再次弹出用户权限提示
date: 2019-08-05
tags:
  - 杂物篇
categories:
  - 杂物篇
---

:::tip
问题描述
通过百度地图API获取本地地理位置的时候，会有一个弹框提示，问是否允许百度地图定位，这个时候如果你点击了允许，那么下次进来的时候也
ios安卓调用百度地图API获取地理位置第一,二次弹框询问是否允许,第三次进入不弹框默认的是上一次的是否允许状态每次都询问是否允许
所以，在ios上会产生一个问题，如果我上一次不允许的话，那么我之后每一次都是不允许的状态，也无法执行接下来的操作了。
解决方案...
:::

<!-- more -->

## 问题描述
在ios上，通过百度地图API获取本地地理位置的时候，会有一个弹框提示，问是否允许百度地图定位，而这个弹框只在第一第二次会弹出，第三次不会弹出，默认使用你上一次选择的权限。
```mermaid
graph LR
A(调用百度地图API获取地理位置) -- ios --> 第一,二次弹框询问是否允许,第三次进入不弹框默认的是上一次的是否允许状态
A -- 安卓 --> 每次都询问是否允许
```
所以，在ios上会产生一个问题，如果我上一次不允许的话，那么我之后每一次都是不允许的状态，也无法执行接下来的操作了。
## 解决方案
为此，我留言询问了一下百度地图官方，
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190805180049231.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzk3MjQzNw==,size_16,color_FFFFFF,t_70)
[http://www.skyfox.org/html5-geolocation-safari-user-permission-prompt.html](http://www.skyfox.org/html5-geolocation-safari-user-permission-prompt.html)
解决办法也很坑爹，需要我们打开手机的
***设置 - 通用 - 还原 - 还原位置与隐私***
然后去
***设置 - 隐私 - 定位服务打开***
算是勉强解决了吧。只不过还原的是整个手机的位置与隐私权限，打开你之前的app就会再次询问你是否允许什么什么权限，略显坑爹。。
