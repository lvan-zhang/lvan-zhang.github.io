---
title: 小程序：几种传值方案
date: 2019-10-25
tags:
  - 小程序
categories:
  - 小程序
---

:::tip
通过url拼接参数
1.1 固定参数
例子：从 list 页面到 detail 页面, 传递一个或多个固定值
&lt;!--pages/list/list.wxml--&gt;
&lt;navigator url="../detail/detail?id=1&amp;name=名称"&gt;点此进入 detail&lt;/navigator&gt;

&lt;!--pages/list/list....
:::

<!-- more -->

## 通过url拼接参数
### 1.1 固定参数
例子：从 list 页面到 detail 页面, 传递一个或多个固定值
```html
<!--pages/list/list.wxml-->
<navigator url="../detail/detail?id=1&name=名称">点此进入 detail</navigator>
```
```html
<!--pages/list/list.wxml-->
<block wx:for="{{ orderList }}"
       wx:key="{{ index }}">
  <navigator url="/pages/order-detail/order-detail?id={{ item.id }}">
    <text>{{ item.name }}</text>
  </navigator>
</block>
```
```js
// pages/detail/detail.js
onLoad: function (options) {
    console.log(options.id) // 1
    console.log(options.name) // 名称
}
```
### 1.2 从列表取值
在列表页进入详情页的按钮上绑定被点击的 id，
```html
<!--pages/list/list.js-->
<button class="goods-item"
      data-id="{{ item.id }}"
      bindtap="toDetail">
    <view>{{ item.name }}</view>
</button>
```
```js
// pages/detail/detail.js
toDetail (e) {
  wx.navigateTo({
    url: '/pages/goods-detail/goods-detail?id=' + e.currentTarget.dataset.id,
  })
},
```
### 1.3 传递对象
还是上面的方式，只不过加上
```js
// 传递时：
JSON.stringify(obj)
// 接受时
JSON.parse(options.obj)
```
### 1.4 传递链接
传递链接的时候需要编码解码，否则会误把链接中?后面参数丢失
```js
// 传递时：
encodeURIComponent(url)
encodeURIComponent(JSON.stringify(model))
// 接受时
decodeURIComponent(options.url)
JSON.parse(decodeURIComponent(options.model))
```
## 通过本地缓存
默认可以缓存10M的数据
```js
wx.setStorageSync('checkin', checkin)
wx.getStorageSync('checkin')
```
## 通过全局app
```js
//往globalData设置值
getApp().globalData.data = "12345";
//取globaData的值
var data = app.globalData.data;

App({
  globalData: {
    data:XXX
  }
})
```
